---
title: "The Influence of Individual Characterisitcs on Public Transportation Planning"
author: "Iris Zhong"
abstract: xx
thanks: xx
header-includes:
   - \usepackage{booktabs}
   - \usepackage{setspace}
   - \doublespacing
   - \usepackage[labelfont=bf]{caption}
output: 
  pdf_document:
    number_sections: true
    keep_tex: true
# bibliography: sample.bib
---

```{r setup, echo = F, message = F}
knitr::opts_chunk$set(results = 'asis', cache = F)
library(tidyverse)
library(lubridate)
library(stargazer)
library(corrplot)
library(Hmisc)
library(dlookr)
load("processed_data/analysis_data.RData")
```


# Literature Review

Allen et al. (2016) study the reasoning of the failure of a referendum on a congestion charging scheme in Edinburgh. Instead of using direct voting data, they conduct a survey after the referendum, which allows them to ask more specific questions. Researchers can gain detailed data by surveying, because the unit of measurement is each individual; however, a possible disadvantage of surveying is that respondents who turn in the questionnaire tend to have stronger attitudes towards the proposal, generating sampling bias. They conclude that people who use cars as the primary transportation mean, demonstrate a misconception of the pricing plan, or question the effectiveness of the scheme at reducing congestion are more likely to oppose it. Their findings can give insights to the similar failure in the Gwinnett referendum. Voters against the proposal could be those who rarely use public transportation and those who are not convinced by the effectiveness of expanding public transit in alleviating the traffic. 

Another crucial factor is the accessibility of the proposed transit system. Kinsey et al. (2010) examine the relationship between the distance to the scheduled railway station and voter turnout by studying the Seattle monorail referendum. They introduce the concept of diffused and concentrated benefit/cost. People who live far from the monorail enjoy the diffused benefit of less traffic congestion, and bear the diffused cost of increased tax. People living close to the rail experience the same diffused benefit and cost, but they also gain the concentrated benefit of easily accessing the public good. Finally, those who live very close to the railway have the same benefits and costs, but they also face the concentrated cost such as inconvenience during construction. Since “people are more strongly motivated to avoid losses than to approach gains,” they expect a higher turnout rate in farther places with votes for “no,” which is verified from their analyses. Besides distance, they also find out precincts with a higher percentage of people of lower socioeconomic status or young people have a lower turnout rate. Interestingly, there is a significant interaction between partisanship and distance, which would be also tested in my study. In essence, the effect of distance on turnout is weakened by partisanship, and vanishes beyond a threshold of distance. Even though my dependent variable is voters’ responses rather than turnout, it can be inferred from Kinsey et al.’s findings that people farther away from the transit system would vote against the referendum more. However, the relationship might be non-linear and requires some form of transformation. Regarding the methods, they utilize the spatial lag model to correct for autocorrelation, which is proper to use in my project as well since both studies use precinct-level data. 

# Background

current transportation
future plan
referendum

# Data & Methods

## Conceptual model

According to previous research, sociodemographic elements can influence people’s voting decisions in the referendum. For example, the effect of income is mixed: on the one hand, people with higher income will pay a smaller portion of their earnings for the implementation of the plan; on the other hand, they will pay a larger amount of tax. Bollino (2008) finds a positive correlation between income and people’s willingness to pay for renewable resources. Burkhardt and Chan (2017) separate the influence of income from tax, and discover their opposite effects on voting. Therefore, it is worth considering the relationship between income and percentage of supporters in this referendum. Voters’ partisanship attachment is found to be a significant factor as well in Burkhardt and Chan’s (2017) paper. Areas with higher proportions of Republicans are less supportive of fiscally costly propositions. In my project, it can be hypothesized that tracts that have a higher proportion of Trump supporters tend to have a lower percentage of agreement to the proposal.  

In addition, some factors related to transportation can intuitively shape people’s attitudes towards public transit. For example, the areas in which people do not use public transit at all might have a higher percentage of refusal of the proposal. People who have to travel a long time to work are more likely to support the extension plan if it helps save time. These two factors serve as controls in the models.

Finally, people favor the proposition if it benefits them. Specifically, tracts that are not covered by public transport at present but will be covered in the expansion plan are predicted to support the proposal more.



## Data

The ballot results of the Gwinnett County referendum on Mar 19th, 2019 is obtained from a website powered by Scytl, a trusted source of election outcomes. The cross-sectional dataset contains the voting information of all 157 precincts in the county. The dependent variable -- the proportion of supporters of the referendum, and the voter turnout rate are calculated from this data source.

The result of the 2016 Presidential Election is chosen to reflect partisanship. A cross-sectional precinct-level election data is obtained from the MIT Election Data and Science Lab website. The number of votes for Trump at each precinct in Gwinnett county comes from this dataset. 

Next, cross-sectional sociodemographic characteristics at the census tract level are found in Census Bureau via an R package called `tidycensus`. The data comes from the American Community Survey 5-year estimate published in 2018. The median age and median income are collected here. In addition, the proportion of white, the percentage of people who go to work by public transportation, and the percentage of people who travel more than an hour to work are calculated by dividing the relevant variables by the total population or the survey sample size. 

The information on whether the tract enjoys the proximity of public transportation now and future can be acquired from spatial maps and analyses. First, a precinct-level shapefile of Gwinnett County made in 2018 is obtained from the Georgia General Assembly. Gwinnett County maps with current and proposed future public transit systems are available on the Gwinnett County government website. I select the short-range expansion plan (Y2020 – 2025) because the cost and benefit of the expansion in the far future are discounted more. After modifications in QGIS software, the maps are then transformed into spatial data readable in R. Five-hundred-meter buffer zones are created around bus and railway routes. The categorical variable *current_plan* has four levels: 1 represents no transportation near this tract at present and in the future; 2 represents the tracts that are accessible to public transit currently but not in the future; 3 stands for the tracts that do not have transit at present but will do in the expansion plan; 4 represents the tracts that have and will have public transit for now and for the future. 

As noted above, both referendum and 2016 election data are collected at the precinct level. However, the other datasets are performed at the census tract level. Therefore, referendum and election data are redistributed by the areas shared by the precinct and the tract. See the data appendix for detailed steps of transformation. 

The final dataset joins the datasets above by GEOID. It is cross-sectional, measured with the unit of the census tract. A description of the variables can be found in *Table 1*. 




\begin{table}
\centering
\caption{Variable definitions}
\label{variableDefinitions}
\begin{tabular}{ll}
\hline
\hline
Variable name      & Description                                   \\
\hline
GEOID          & The geographic identifier of the census tract                 \\
medage        & The median age of the population in the tract               \\
medincome        & The median income of the population in the tract               \\
white\_pct           & The percentage of white population in the tract      \\
public\_pct          & The percentage of people who go to work by public transportation (excluding taxi or cab)      \\
time\_pct           & The percentage of people who travel more than an hour to work      \\
trump\_pct          & The estimated percentage of votes for Donald Trump in that tract      \\
voter\_turnout  & The estimated percentage of voters who voted in this referendum in the tract \\
yes\_pct           & The estimated percentage of voters who voted yes in this referendum in the tract      \\
plan\_yes          & Whether the tract is covered by the public transportation now and in the short-range, \\ & defined by whether any transportation is available within 500 meters. \\ & 1 stands for the tract doesn't have transit both now and in the short-range plan. \\ & 2 stands for the tract has transit now but not in the short-range plan. \\ & 3 stands for the tract that doesn't have transit now and will have in the future.\\ & 4 stands for the tract that has public transit both now and in the future      \\

\hline
\end{tabular}
\end{table}



```{r create summary statistic table, echo = F, results = 'asis'}

stargazer::stargazer(as.data.frame(final_data),
                     label = "summaryStats",
                     title = "Summary statistics",
                     header = F,
                     type = "latex",
                     digits = 2)
```

```{r create correlation matrix}

data_numeric <- final_data %>%
   select(-c(current_plan,GEOID))

data_cor = cor(data_numeric)

data_cor_1 <- rcorr(as.matrix(data_numeric))
M <- data_cor_1$r
p_mat <- data_cor_1$P
corrplot(M, type = "upper", order = "hclust", 
         p.mat = p_mat, sig.level = 0.05)


```

*Table 2* lists the summary statistics. Median income is skewed to the right, with a few tracts demonstrating high income levels. Such a pattern of inequality is universally observed.

The usage of public transit is low. On average, only one percent of the population relies on public transportation to go to work. As proved by later analyses, the distribution is highly skewed, and will be transformed in some models. 
**public_pct max needs to be fixed**

The variable *current_plan* is not in *Table 2* because it is a categorical variable. In sum, 31 tracts do not have access to public transport within 500 meters, both now and in the short-range. There is one tract that is categorized as 2, indicating that it has public transit at present, but not in the short-range proposition. It could be due to the plan of reducing circuitous routing. Twenty-two tracts do not enjoy the proximity of public transport now, but will in the short-range. Lastly, 59 tracts have public transit available both at present and in the short-range plan. Since a level of this variable contains only one value (“2”), problems with degrees of freedom will potentially arise. 

A correlation matrix is created from `corrplot` package to investigate the correlation between each pair of factors (see *Figure ???*). Positive correlations are in blue colors, and negative correlations are in red colors. The magnitude is reflected by the color intensity and the size of the dot. Non-significant (p > 0.05) correlations are marked with a cross. *Current_plan* is omitted in the matrix because it is categorical. The dependent variable *yes_pct* is significantly correlated with every independent variable. *Medage*, *voter_turnout*, *medincome*, *white_pct*, and *trump_pct* are all strongly positively correlated with each other, and all of them are negatively associated with *yes_pct*. Given the number of strong, significant correlations among the factors, it is essential to check collinearity in the regression model. 

The major limitation of the data is the unit conversion from precinct to census tract. Such a method assumes that residents in one precinct have the same characteristics, and population density is identical. Clearly, the assumptions cannot be satisfied in a real dataset. 


## Model specification

Four models are tested in the analysis. The dependent variable is *yes_pct*, the proportion of supporters of the referendum in a tract. Independent variables include *medincome*, *white_pct*, *trump_pct*, and *current_plan*. For more information about these variables, refer to *Table ???*. 

Model 1 adopts linear regression model with all the original variables:


$yes\_pct_t = \beta_0+\beta_1medincome_t+\beta_2white\_pct_t+\beta_3trump\_pct_t+\beta_4current\_plan_t+\beta_5medage_t+\beta_6public\_pct_t+\beta_7time\_pct_t+\beta_8voter\_turnout_t+\epsilon_t$    

xxxxx

Model 2 is identical to Model 1, except that it uses logistic regression. Even though the dependent variable is not binary, previous research has used logistic regression in a similar scenario (???). 


$logit(yes\_pct_t) = \beta_0+\beta_1medincome_t+\beta_2white\_pct_t+\beta_3trump\_pct_t+\beta_4current\_plan_t+\beta_5medage_t+\beta_6public\_pct_t+\beta_7time\_pct_t+\beta_8voter\_turnout_t+\epsilon_t$



```{r include=FALSE}
find_skewness(final_data)
```

*Medincome*, *public_pct* and *voter_turnout* are found to be skewed. Thus, Model 3 uses multiple linear regression after log or square root transformation on these three variables.

$yes\_pct_t = \beta_0+\beta_1log(medincome_t)+\beta_2white\_pct_t+\beta_3trump\_pct_t+\beta_4current\_plan_t+\beta_5medage_t+\beta_6log(public\_pct_t + 0,01)+\beta_7time\_pct_t+\beta_8\sqrt{voter\_turnout_t}+\epsilon_t$     

Finally, Model 4 adopts the same transformation as Model 3, with logistic regression.

$logit(yes\_pct_t) = \beta_0+\beta_1log(medincome_t)+\beta_2white\_pct_t+\beta_3trump\_pct_t+\beta_4current\_plan_t+\beta_5medage_t+\beta_6log(public\_pct_t + 0.01)+\beta_7time\_pct_t+\beta_8\sqrt{voter\_turnout_t}+\epsilon_t$ 


# Results & Discussion


model 1: linear
```{r}

mod1 <- lm(data = final_data, yes_pct ~ medage + medincome + white_pct 
           + public_pct + time_pct + trump_pct + voter_turnout +
              current_plan)
summary(mod1)
```



model 1 assumption checking
```{r}

plot(predict(mod1),resid(mod1),col="midnightblue",pch=18,main="Residual plot - Model 1")
abline(0,0,col="red")
```

collinearity:
```{r}
library(car)
vif(mod1)
```

all below 5: good, no collinearity problem





model 2: no interaction, logistic
```{r}
mod2 <- glm(data = final_data, yes_pct ~ medage + medincome + white_pct + public_pct + time_pct + trump_pct + voter_turnout + current_plan, family = "binomial")
summary(mod2)
```

model 1 & 2 table
```{r generate model 1 table, echo = F, results = 'asis'}

stargazer::stargazer(list(mod1, mod2), 
               title = "Initial regression results", 
               label = "initialResults",
               header = F,
               notes = "Initial linear and logistic regression results",
               notes.align = "l")
```



model 3: no interaction, some transformations, linear

step 1: find the skewed variables



medincome, public_pct, voter_turnout

step 2: transform them
```{r}
data_tf <- final_data %>%
   mutate(log_medincome = log(medincome),
          log_public_pct = log(public_pct + 0.01),
          sqrt_voter_turnout = (voter_turnout)^0.5) %>%
   select(-c(medincome, public_pct, voter_turnout))
find_skewness(data_tf)
```

step 3: model them

```{r}
mod3 <- lm(data = data_tf, yes_pct ~ medage + log_medincome + white_pct + log_public_pct + time_pct + trump_pct + sqrt_voter_turnout + current_plan)
summary(mod3)
```

model 3 assumption checking
```{r}

plot(predict(mod3),resid(mod3),col="midnightblue",pch=18,main="Residual plot - Model 3")
abline(0,0,col="red")
```

collinearity:
```{r}
vif(mod3)
```

all below 5: no collinearity



model 4: transformation, logistic
```{r}
mod4 <- glm(data = data_tf, yes_pct ~ medage + log_medincome + white_pct 
           + log_public_pct + time_pct + trump_pct + sqrt_voter_turnout +
              current_plan, family = "binomial")
summary(mod4)
```


model 3 & 4 table
```{r generate model 3&4 table, echo = F, results = 'asis'}

stargazer::stargazer(list(mod3, mod4), 
               title = "Data-transformed regression results", 
               label = "transformedResults",
               header = F,
               notes = "Data-transformed linear and logistic regression results",
               notes.align = "l")
```

```{r}

mod5<- lm(data = data_tf, yes_pct ~ medage + log_medincome + white_pct + trump_pct
           + log_public_pct + time_pct  + sqrt_voter_turnout +
              current_plan)
summary(mod5)
anova(mod5,mod3)
```



```{r}
ggplot(final_data, aes(x = trump_pct, y = medincome)) +
   geom_point(aes(colour = white_pct))
```




```{r}
ggplot(final_data, aes(x = white_pct, y = yes_pct))+
   geom_point()
```

# References
